#!/bin/bash

path=$(fd --type=d --hidden --no-ignore ".git" --exclude node_modules --exclude tmp --absolute-path "$HOME/Projects" | grep ".git/" | sd "/.git/" "" | fzf)
if [ "$path" != "" ]; then
  pname=$(basename "$path")

  if [[ -n "$WEZTERM_PANE" ]]; then
    wezterm cli set-tab-title "$pname"
    printf "z %s\n" "$path" | wezterm cli send-text --pane-id "$WEZTERM_PANE" --no-paste # wezterm resolves the home symlink to /var/home, breaking some stuff
    printf "nvim\n" | wezterm cli send-text --pane-id "$WEZTERM_PANE" --no-paste
  fi
fi
